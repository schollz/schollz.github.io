<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Zack&#39;s Notablog | Watercoloring with neural networks</title><meta name=description content="Can a neural network help me improve my art? Could I take a photo, paint it, and then use a neural network to render the original photo in the style of my painting to make it better?"><meta name=image content><meta itemprop=name content="Watercoloring with neural networks"><meta itemprop=description content="Can a neural network help me improve my art? Could I take a photo, paint it, and then use a neural network to render the original photo in the style of my painting to make it better?"><meta itemprop=image content><meta name=twitter:card content=summary><meta name=twitter:title content="Watercoloring with neural networks"><meta name=twitter:description content="Can a neural network help me improve my art? Could I take a photo, paint it, and then use a neural network to render the original photo in the style of my painting to make it better?"><meta name=twitter:site content=@yakczar><meta name=twitter:creator content=@yakczar><meta name=twitter:image:src content><meta name=og:title content="Watercoloring with neural networks"><meta name=og:description content="Can a neural network help me improve my art? Could I take a photo, paint it, and then use a neural network to render the original photo in the style of my painting to make it better?"><meta name=og:image content><meta name=og:url content=/watercolor/><meta name=og:site_name content="Watercoloring with neural networks"><meta name=og:type content=article><meta name=article:author content=yakczar><meta name=article:tag content=painting><link rel=stylesheet href=/css/style4.css><script src=/js/caption.js></script><link rel=icon type=image/png href=/img/favicon/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon/favicon-16x16.png sizes=16x16><script>function getJSON(url){var script=document.createElement('script');script.setAttribute('src',url);script.setAttribute('type','text/javascript');document.getElementsByTagName('head')[0].appendChild(script);}
function cbfunc(data1){console.log(data1);var quoteP=document.getElementById("quoteP");quoteP.innerHTML="<em>“"+data1.text+"” - "+data1.name+"</em>";}
getJSON("https:\/\/randomquote.schollz.com?callback=cbfunc")</script><img src="https://analytics.schollz.com/1.png?page=%2fwatercolor%2f" width=1px height=1px style=float:right><div id=header><div class=left></div><div class=right></div></div><script>var elements=document.querySelectorAll("img");Array.prototype.forEach.call(elements,function(el,i){if(el.getAttribute("alt")){const caption=document.createElement('figcaption');var node=document.createTextNode(el.getAttribute("alt"));caption.appendChild(node);const wrapper=document.createElement('figure');wrapper.className='image';el.parentNode.insertBefore(wrapper,el);el.parentNode.removeChild(el);wrapper.appendChild(el);wrapper.appendChild(caption);}});</script><div id=documentbody><div class=wtblog><div class=maintext><div class="wikitext titlehack"><h1>Watercoloring with neural networks</h1><div class=posttitle><small>June 14, 2017</small></div></div><div class=wikitext><p>Can a neural network help me improve my art? Could I take a photo, paint it, and then use a neural network to render the original photo in the style of my painting to make it better? Could I learn something from it?<h2 id=some-background>Some background</h2><p>I started thinking about these questions because I’ve been reading about neural networks, and I’ve seen a lot of these neural networks create new works of art by rendering a photo in the style of a famous painting<sup class=footnote-ref id=fnref:1><a href=#fn:1>1</a></sup>.<p><img src=/img/rosseauscat.jpg alt='The "content" of Jean-Jacques Rosseau’s painting is recognizable as a cat, despite the painting "style".'><p>Neural networks are complicated and worth reading about<sup class=footnote-ref id=fnref:2><a href=#fn:2>2</a></sup>. Basically, a neural network is a system composed of computational “neurons” linked up in a way that is similar to the brain that try to solve problems. The connections between these neurons are given specific weights, as they learn how to classify one thing from another. A neural network understands a painting by looking at its specific features. So far researchers have discovered that paintings have two main transferable features: <em>&ldquo;content&rdquo;</em> and <em>&ldquo;style&rdquo;</em>. When we look at a painting, like Jean-Jacques Rosseau’s cat, we experience both the <em>content</em> and the <em>style</em> of the painting simultaneously, but we can (usually) identify them separately. The <em>content</em> is the the subject of that the painter is trying to convey (the cat), where <em>style</em> is the manner which they convey it (bold colors and strokes, awkward proportions in the legs). Rosseau cannot fool us into thinking he did not paint a cat, even though he did an awfully strange representation of it.<p><img src=/img/tubingen_starry.png alt="Neural network rendered painting in the style of *Starry Night* with the content from Neckarfront houses. Photo credit: github.com slash jcjohnson"><p>Recently, a paper by Gatys, Ecker, and Bethge<sup class=footnote-ref id=fnref:3><a href=#fn:3>3</a></sup> was able to show that <em>representations of content and style are separable</em>. They used an algorithm that makes use of a convolutional neural network<sup class=footnote-ref id=fnref:4><a href=#fn:4>4</a></sup> and demonstrated the separability of content and style by transferring the style of a <em>Starry Night</em> by Van Gogh (i.e. the iconic swirls of dark blue pastel) to a photograph of the Neckarfront houses of Tubingen, Germany.<p>The genius of the paper by Gatys, Ecker, and Bethge<sup class=footnote-ref id=fnref:3><a href=#fn:3>3</a></sup> is that they leverage neural networks for classifying local features in images to extract the representations of content. The neural network used here is the VGG-Network by Simonyan and Zisserman which is the state-of-the-art for identifying things in images<sup class=footnote-ref id=fnref:5><a href=#fn:5>5</a></sup>. To transfer <em>Starry Night</em> to Neckarfront, Gatys, Ecker, and Bethge simply exploited the neural network to copy the set of neurons that finds representations of content (which parts of the image are the “building”), and then using another layer that extracts the style, or texture (i.e. non-features that are local in context, like the swirls in Van Gogh’s painting).<h2 id=making-a-neural-network-to-paint-with-my-style>Making a neural network to paint with my style</h2><p>To make a neural network paint like me, I will first select a photo and then paint the photo myself. Then I will use my painting to generate a neural network rendering from the original photo. That is, I will use the <em>style</em> from the painting I create and transfer it to the <em>content</em> of the photo that I used to create the painting. Technically speaking, I used the algorithm from Gatys, Ecker, and Bethge, as coded by <a href=https://github.com/awentzonline/image-analogies>jcjohnson</a> compiled with the CUDA backend to use on a GTX 1080Ti.<p><img src=/img/heron1.jpg alt="Source photo for painting"><p>I started with a photo of a heron.<p><img src=/img/heron2.jpg alt="My painting"><p>Then, I create my own Gouache painting of the photo.<p><img src=/img/heron3.jpg alt="Transfer of my style to original photo"><p>Finally, I used Torch<sup class=footnote-ref id=fnref:1><a href=#fn:1>1</a></sup> to transfer the <em>style</em> of my painting to the <em>content</em> of the photo to create a neural network rendering.
The results are impressive. The neural network uses my color palette and some of my strokes, but seems to suppress a lot of my mistakes and more precisely articulates the original photo. For example - the wings that I painted are very unordered and sloppy, but the neural network used the original wings and used the idea of my painting to fix them.<h2 id=the-neural-network-becomes-the-teacher>The neural network becomes the teacher</h2><p>The heron is not an outlier. Almost every painting I create can be re-imagined by a neural network to be rendered as a much cleaner and more professional painting<sup class=footnote-ref id=fnref:6><a href=#fn:6>6</a></sup>. The machine makes a professional out of a novice.<p>Here are more examples showing the original photo (left), my painting of the photo (middle) and the neural network rendering of the photo using the style of my painting (right). After looking at them quite a bit, I can see some simple things I can do to improve my own painting.<p>Click on any of the paintings to see them in full resolution.<h3 id=cat>Cat</h3><p>I like how the neural network put more white around the eyes and also patches of gray to shadow the eye and mouth. I could have also been more liberal with my striping on the arm.<p><a href=/img/cat.jpg><img src=/img/cat.jpg alt></a><h3 id=bison>Bison</h3><p>Though I like the original watercoloring better, I think the neural network does a better job on the bison&rsquo;s hair on its head - using a reddish color and blending it out.<p><a href=/img/bison.jpg><img src=/img/bison.jpg alt></a><h3 id=koala>Koala</h3><p>My mistakes fixed by the neural network - I made the yellow around the baby koala is too wide, and its head too light. I love the neural network ears - they aren&rsquo;t outlined so it gives them a lighter touch, and the fur on the big koala has more brush strokes which makes it more dynamic.<p><a href=/img/koala.jpg><img src=/img/koala.jpg alt></a><h3 id=deer-and-cat>Deer and cat</h3><p>I also think my rendition for the watercolor is very good, although I wish I had gotten the proportions better, as it looks a lot nicer. Also a thinner outline would have been better, as the neural network does. I also love how the neural network reinterprets the background - putting in more orange and gray which complements the deer and cat.<p><a href=/img/deer.jpg><img src=/img/deer.jpg alt></a><h3 id=fox>Fox</h3><p>I had a lot of trouble on the tail of this fox, and the neural network has a great way of doing it - simply dab the outside and then blend in the grey and red. I also love the purple on the fox hind leg, which I was not bold enough in bringing out on my own painting.<p><a href=/img/fox.jpg><img src=/img/fox.jpg alt></a><h3 id=dog-and-owl>Dog and owl</h3><p>I love my painting here as well, but the proportions are wrong, my dog is far to narrow. I also could have shadowed the snout a little differently, to make the sides of the head stand out more, like in the neural network.<p><a href=/img/dogandowl.jpg><img src=/img/dogandowl.jpg alt></a><h3 id=mountain-goat>Mountain Goat</h3><p>A white animal is <em>very</em> difficult for me, but I think the neural network shows a possible solution: focus on the middle with gray/blue and then on the outside with yellow.<p><a href=/img/mtngoat.jpg><img src=/img/mtngoat.jpg alt></a><h2 id=conclusion>Conclusion</h2><p>It seems a computer is better at painting than I am.<p>But seriously, this is a rather neat illustration of the separation of <em>content</em> and <em>style</em>. In the future I would like to instead train my own neural network with a corpus of my photos and illustrations to transfer my style to photos. In this case, I imagine it will be agnostic to <em>content</em> but will merely encode my style. I have to learn how to train neural networks first, though.<div class=footnotes><hr><ol><li id=fn:1>Some great resources on Github are <a href=https://github.com/awentzonline/image-analogies>awentzonline&rsquo;s image analogies</a> and <a href=https://github.com/jcjohnson/neural-style>jcjohnsons&rsquo;s Torch implementation of neural styles</a>.
<a class=footnote-return href=#fnref:1><sup>[return]</sup></a><li id=fn:2><a href=https://neuralnetworksanddeeplearning.com/>Here is a great, free, online book</a> written by Michael Nielsen which gives a great introduction to neural networks.
<a class=footnote-return href=#fnref:2><sup>[return]</sup></a><li id=fn:3>Gatys, Leon A., Alexander S. Ecker, and Matthias Bethge. &ldquo;A neural algorithm of artistic style.&rdquo; arXiv preprint arXiv:1508.06576 (2015).
<a class=footnote-return href=#fnref:3><sup>[return]</sup></a><li id=fn:4>A convolutional neural network is a special kind of neural network that links up the computer neurons in a way that mimics how the visual cortex operates.
<a class=footnote-return href=#fnref:4><sup>[return]</sup></a><li id=fn:5>Simonyan, Karen, and Andrew Zisserman. &ldquo;Very deep convolutional networks for large-scale image recognition.&rdquo; arXiv preprint arXiv:1409.1556 (2014).
<a class=footnote-return href=#fnref:5><sup>[return]</sup></a><li id=fn:6>The cases where the neural network did poorly was in paintings where I left the background completely white.
<a class=footnote-return href=#fnref:6><sup>[return]</sup></a></ol></div></div><br><div class=collapse tabindex=1><a id=commenttoggle href=#commentssection onclick="toggle_visibility('commentssection');">Show comments <span id=commentsnum></span></a><script>function toggle_visibility(id){var e=document.getElementById(id);if(e.style.display=='block'){e.style.display='none';document.getElementById("commenttoggle").innerText="Show comments";}else{e.style.display='block';document.getElementById("commenttoggle").innerText="Hide comments";}}</script><div id=commentssection style=display:none><hr><div id=comments></div><div class=guestbook-form><strong>Leave a comment:</strong>
<textarea rows=5 cols=75 id=message name=message class=guestbook></textarea><br><table style=margin-bottom:0><tr><td style=padding-right:10px><label for=name>Who are you?</label><td><input id=name class=guestbook size=40><tr><td style=padding-right:10px><label for=whourl>(optional URL)</label><td><input id=email class=guestbook size=40 type=url><tr><td><input class=guestbook-button type=button id=btn value=Submit></table></div><script>var serverURL="https:\/\/guestbook.schollz.com"
var btn=document.getElementById("btn");var guestbook=document.getElementById("comments");var firstMessage=0;function myCallback(acptlang){if(acptlang.Message!=""&&firstMessage==1){alert(acptlang.Message);firstMessage=1;}
guestbook.innerHTML="";if(acptlang.Entries.length>0){var commentsNum=document.getElementById("commentsnum");commentsNum.innerText="("+acptlang.Entries.length+")"}
for(var i=0;i<acptlang.Entries.length;i++){guestbook.innerHTML=guestbook.innerHTML+
`<div class="comment">
    <div class="entryid"> By ${acptlang.Entries[i].Name} on ${acptlang.Entries[i].DateString} in ${acptlang.Entries[i].Location}: </div>
    <blockquote> <div class="wikitext">${acptlang.Entries[i].Message}
    </div> </blockquote> </div>`}}
function jsonp(){guestbook.innerHTML="Loading ...";var tag=document.createElement("script");var message=encodeURIComponent(document.querySelector('#message').value);var name=encodeURIComponent(document.querySelector('#name').value);var email=encodeURIComponent(document.querySelector('#email').value);tag.src=`${serverURL}/jsonp?callback=myCallback&message=${message}&name=${name}&email=${name}`;document.querySelector("head").appendChild(tag);}
btn.addEventListener("click",jsonp);guestbook.innerHTML="Loading ...";var tag=document.createElement("script");var message=encodeURIComponent(document.querySelector('#message').value);var name=encodeURIComponent(document.querySelector('#name').value);var email=encodeURIComponent(document.querySelector('#email').value);tag.src=`${serverURL}/jsonp?callback=myCallback&message=${message}&name=${name}&email=${name}`;document.querySelector("head").appendChild(tag);</script></div><br></div><small>Written on <a href=/written/2017-06-14>14</a>
<a href=/written/2017-06>June</a>
<a href=/written/2017>2017</a>.
Categories:
<a href=/tags/painting/>painting</a>.</small><br><br><table border=0 width=100%><tr><td width=50% style=padding-right:.5em><table><tr><td>&laquo;<td><a href=/quines/>Autological words and quines</a>&nbsp;</table><td width=50% style="padding-left:.5em;border-left:1px dotted"><table><tr><td><a href=/recursive-ingredients/ style=float:right>Recursive ingredients</a><td>&raquo;</table></table></div><div class=sidebar><div class=readme><div class=wikitext><p><a href=/>Full index of entries</a><p>Subjects:
<a href=/tags/bitcoin>bitcoin</a>&nbsp;
<a href=/tags/books>books</a>&nbsp;
<a href=/tags/brain>brain</a>&nbsp;
<a href=/tags/coding>coding</a>&nbsp;
<a href=/tags/food>food</a>&nbsp;
<a href=/tags/golang>golang</a>&nbsp;
<a href=/tags/language>language</a>&nbsp;
<a href=/tags/open-source>open-source</a>&nbsp;
<a href=/tags/painting>painting</a>&nbsp;
<a href=/tags/protein-folding>protein-folding</a>&nbsp;
<a href=/tags/running>running</a>&nbsp;
<a href=/tags/science>science</a>&nbsp;
<a href=/tags/thoughts>thoughts</a>&nbsp;
<a href=/tags/tools>tools</a>&nbsp;<p>Github:
<a href=https://github.com/schollz>@schollz</a><p>Twitter:
<a href=https://twitter.com/yakczar>@yakczar</a><p align=center>* * *<p id=quoteP><div class=sidesearch style=font-size:small><form onsubmit="location.href='/search/?s='+document.getElementById('myInput').value;return false;">Search:
<input id=myInput size=15></form></div><p><a href=/about>About</a>&nbsp;&middot;&nbsp;<a href=/index.xml>RSS feed</a></div></div></div></div></div>