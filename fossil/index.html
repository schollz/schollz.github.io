<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Zack&#39;s Notablog | Self-hosting with fossil, an alternative to git</title><meta name=description content><meta name=image content><meta itemprop=name content="Self-hosting with fossil, an alternative to git"><meta itemprop=description content><meta itemprop=image content><meta name=twitter:card content=summary><meta name=twitter:title content="Self-hosting with fossil, an alternative to git"><meta name=twitter:description content><meta name=twitter:site content=@yakczar><meta name=twitter:creator content=@yakczar><meta name=twitter:image:src content><meta name=og:title content="Self-hosting with fossil, an alternative to git"><meta name=og:description content><meta name=og:url content=/fossil/><meta name=og:site_name content="Self-hosting with fossil, an alternative to git"><meta name=og:type content=article><meta name=article:author content=yakczar><meta name=article:tag content="coding golang"><link rel=stylesheet href=/css/style4.css><script src=/js/caption.js></script><link rel=icon type=image/png href=/img/favicon/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon/favicon-16x16.png sizes=16x16><script>function getJSON(url){var script=document.createElement('script');script.setAttribute('src',url);script.setAttribute('type','text/javascript');document.getElementsByTagName('head')[0].appendChild(script);}
function cbfunc(data1){console.log(data1);var quoteP=document.getElementById("quoteP");quoteP.innerHTML="<em>“"+data1.text+"” - "+data1.name+"</em>";}
getJSON("https:\/\/randomquote.schollz.com?callback=cbfunc")</script><img src="https://analytics.schollz.com/1.png?page=%2ffossil%2f" width=1px height=1px style=float:right><div id=header><div class=left></div><div class=right></div></div><script>var elements=document.querySelectorAll("img");Array.prototype.forEach.call(elements,function(el,i){if(el.getAttribute("alt")){const caption=document.createElement('figcaption');var node=document.createTextNode(el.getAttribute("alt"));caption.appendChild(node);const wrapper=document.createElement('figure');wrapper.className='image';el.parentNode.insertBefore(wrapper,el);el.parentNode.removeChild(el);wrapper.appendChild(el);wrapper.appendChild(caption);}});</script><div id=documentbody><div class=wtblog><div class=maintext><div class="wikitext titlehack"><h1>Self-hosting with fossil, an alternative to git</h1><div class=posttitle><small>June 10, 2018</small></div></div><div class=wikitext><p>Github, Gitlab, Bitbucket are all web interfaces for <em>git</em>. They all do similar things that add on features that aren&rsquo;t implicit in <em>git</em>, like issues and wiki, etc.<p>Unbeknownst to some, <em>fossil</em> is an alternative to <em>git</em> that actually has built-in issues, wiki, and easily self-hosts. This is a quickstart to get started with hosting and cloning <em>fossil</em> repos. The <a href=http://www.fossil-scm.org/index.html/doc/2010-01-01/www/quickstart.wiki>official quickstart</a> is very good, although I realized a few tricks in getting the <a href=#hosting>fossil hosting to work on HTTPS</a> behind a reverse-proxy and getting <a href=#go>fossil to work with Go</a>.<h2 id=before-you-begin>Before you begin</h2><p>First, download fossil. There are already binaries available for <em>fossil</em>, you can find them <a href=https://www.fossil-scm.org/xfer/uv/download.html>here</a>.<h2 id=new>New fossil</h2><p>Make sure to save each fossil repo with the extension <code>.fossil</code> - this is very important if you want to do hosting.<p>Now you can make a new fossil with the <code>init</code> subcommand.<pre><code>&gt; fossil init -A schollz 3.fossil
project-id: 7165366dc9d0d3c827573c8ef12cb760f2caa236
server-id:  56adcebbf59b06eb4b621d3daca59f5aa87a9a08
admin-user: schollz (initial password is &quot;35a6g1&quot;)
</code></pre><p>This will make a new repository, <code>3.fossil</code>, with a user <code>schollz</code> and default password <code>35a6g1</code>. You can then change the default password for <code>schollz</code>. Here you have to enter the password on the command-line, but I like to add it to a file to prevent it from showing up in the bash history.<pre><code>&gt; vim pass # enter your password in this file
&gt; fossil user password schollz `cat pass` -R 3.fossil
&gt; rm pass # this ensures your password doesn't enter the bash history
</code></pre><p>Want to add another user? Its also easy:<pre><code>&gt; fossil user new user2 user2@somewhere.com -R 3.fossil
</code></pre><h2 id=hosting>Hosting fossils</h2><p>Say now you have several fossils in the same folder. Make sure that each has the <code>.fossil</code> suffix - this is very important.<pre><code>&gt; ls fossils
1.fossil 2.fossil 3.fossil
</code></pre><p>Then you can start a server that uses HTTPS:<pre><code>&gt; fossil server . --https --port 8079 --repolist
</code></pre><p>The <code>--https</code> flag implies HTTPS, so you have to host a reverse-proxy that uses SSL. Its super easy to do this if you are using <a href=https://caddyserver.com/download>Caddy</a> as a reverse-proxy (which easily adds HTTPS). In this case your <a href=https://caddyserver.com/tutorial/caddyfile>Caddyfile</a> will look like:<pre><code>fossil.schollz.com {
        proxy / 127.0.0.1:8079 {
                transparent
        }
        gzip
        log logs/fossil.schollz.com.log
}
</code></pre><p>where you just replace <code>fossil.schollz.com</code> with <code>yourdomain.com</code>.<h2 id=cloning>Cloning fossil</h2><p>Cloning is easy, just make sure to include your user name so you will have the rights to push changes (unless you want to just have your own copy). If you are using &ldquo;<code>fossil server .</code>&rdquo; like above, then you need to add <code>/repo</code> to tell it you want to clone <code>repo.fossil</code>. For instance, to clone <code>3.fossil</code><pre><code>fossil clone https://schollz@fossil.schollz.com/3 3.fossil
</code></pre><p>You will be prompted for the password, which is the same password that you set up top. Now you can open the repo.<pre><code>&gt; fossil open 3.fossil
</code></pre><p>Things are then pretty similar to <em>git</em>. You can add and commit files:<pre><code>&gt; touch README.md
&gt; fossil add README.md
&gt; fossil commit README.md # this will automatically push
</code></pre><p>You can easily create pull (get latest changes):<pre><code>&gt; fossil sync
</code></pre><h2 id=access>Private and public repos</h2><h3 id=private-repos>Private repos</h3><p>It&rsquo;s pretty easy to make your fossil private. Just goto Admin -&gt; Security Audit and then click &ldquo;Take it private&rdquo;.<h3 id=public-repos>Public repos</h3><p>This is the default. However, sometimes if you take your repo private you&rsquo;d like to make it public again. Making your repository public again is a little more involved.<p>Basically there are two types of users: &ldquo;nobody&rdquo; and &ldquo;anonymous&rdquo; users. The &ldquo;anonymous&rdquo; refers to permissions given to <em>anyone who logs in</em>. The &ldquo;nobody&rdquo; refers to the permissions given to <em>anyone who visits</em> the site. To make a repo public again you have to redefine the permissions for both these types of users by going to Admin -&gt; Users.<p>The typical permissions for &ldquo;nobody&rdquo; for public access are &ldquo;gjozr&rdquo;:<p><img src=/img/nobody.PNG alt='Permissions for public access for "nobody" (those who log in).'><p>The typical permissions for &ldquo;anonymous&rdquo; for public access are &ldquo;chmn&rdquo;:<p><img src=/img/chmn.PNG alt='Permissions for public access for "anonymous" (those who log in).'><h2 id=go>Configure for <code>Go</code></h2><p>In order to use <em>fossil</em> with <code>go get</code> you need to make sure you have the right <a href=https://golang.org/cmd/go/#hdr-Remote_import_paths>remote import paths</a> specified in the <code>meta</code> tag.<p>Basically, if you are following the above and you have a fossil repo hosted at <code>https://yourdomain.com/hello-world</code> then you need to include the meta tag:<pre><code>&lt;meta name=&quot;go-import&quot; content=&quot;yourdomain.com/hello-world fossil https://yourdomain.com/hello-world&quot;&gt;
</code></pre><p>You can do this by changing the default fossil skin (Admin -&gt; Skins). There is a really nice <a href="http://fossil.include-once.org/fossil-skins/raw/googlecode.txt?name=1c1738c248dc1f5784e402a466e926bfd9a703e4">Google Code skin</a> available. For convenience, I already have the <a href=https://cowyo.com/fossil_css/raw>CSS</a>, <a href=https://cowyo.com/fossil_header2/raw>Header</a>, and <a href=https://cowyo.com/fossil_footer/raw>Footer</a>. Just edit each component (Step 4 under Skins) and then check both boxes in Step 7 and hit &ldquo;Publish Draft1&rdquo;.<h2 id=general>General</h2><p>I like to have the <code>README.md</code> in the main repo be the first thing you see on the web UI - just like Github/Gitlab/Bitbucket. To do this, make a <code>README.md</code> file and then goto Admin -&gt; Configuration and look for the <strong>Index Page</strong> and change it to <code>/doc/tip/README.md</code>. Make sure to then press &ldquo;Apply Changes&rdquo; at the top.<p>Another trick - you can add <code>fossil</code> as a parameter to your <code>~/.zshrc</code> if
you are using <em>oh-my-zsh</em> (if you aren&rsquo;t using it, why?). Just make sure
you have this line:<pre><code>plugins=(git history fossil) 
</code></pre></div><br><div class=collapse tabindex=1><a id=commenttoggle href=#commentssection onclick="toggle_visibility('commentssection');">Show comments <span id=commentsnum></span></a><script>function toggle_visibility(id){var e=document.getElementById(id);if(e.style.display=='block'){e.style.display='none';document.getElementById("commenttoggle").innerText="Show comments";}else{e.style.display='block';document.getElementById("commenttoggle").innerText="Hide comments";}}</script><div id=commentssection style=display:none><hr><div id=comments></div><div class=guestbook-form><strong>Leave a comment:</strong>
<textarea rows=5 cols=75 id=message name=message class=guestbook></textarea><br><table style=margin-bottom:0><tr><td style=padding-right:10px><label for=name>Who are you?</label><td><input id=name class=guestbook size=40><tr><td style=padding-right:10px><label for=whourl>(optional URL)</label><td><input id=email class=guestbook size=40 type=url><tr><td><input class=guestbook-button type=button id=btn value=Submit></table></div><script>var serverURL="https:\/\/guestbook.schollz.com"
var btn=document.getElementById("btn");var guestbook=document.getElementById("comments");var firstMessage=0;function myCallback(acptlang){if(acptlang.Message!=""&&firstMessage==1){alert(acptlang.Message);firstMessage=1;}
guestbook.innerHTML="";if(acptlang.Entries.length>0){var commentsNum=document.getElementById("commentsnum");commentsNum.innerText="("+acptlang.Entries.length+")"}
for(var i=0;i<acptlang.Entries.length;i++){guestbook.innerHTML=guestbook.innerHTML+
`<div class="comment">
    <div class="entryid"> By ${acptlang.Entries[i].Name} on ${acptlang.Entries[i].DateString} in ${acptlang.Entries[i].Location}: </div>
    <blockquote> <div class="wikitext">${acptlang.Entries[i].Message}
    </div> </blockquote> </div>`}}
function jsonp(){guestbook.innerHTML="Loading ...";var tag=document.createElement("script");var message=encodeURIComponent(document.querySelector('#message').value);var name=encodeURIComponent(document.querySelector('#name').value);var email=encodeURIComponent(document.querySelector('#email').value);tag.src=`${serverURL}/jsonp?callback=myCallback&message=${message}&name=${name}&email=${name}`;document.querySelector("head").appendChild(tag);}
btn.addEventListener("click",jsonp);guestbook.innerHTML="Loading ...";var tag=document.createElement("script");var message=encodeURIComponent(document.querySelector('#message').value);var name=encodeURIComponent(document.querySelector('#name').value);var email=encodeURIComponent(document.querySelector('#email').value);tag.src=`${serverURL}/jsonp?callback=myCallback&message=${message}&name=${name}&email=${name}`;document.querySelector("head").appendChild(tag);</script></div><br></div><small>Written on <a href=/written/2018-06-10>10</a>
<a href=/written/2018-06>June</a>
<a href=/written/2018>2018</a>.
Categories:
<a href=/tags/coding/>coding</a>, <a href=/tags/golang/>golang</a>.</small><br><br><table border=0 width=100%><tr><td width=50% style=padding-right:.5em><table><tr><td>&laquo;<td><a href=/ipfs-enabled-personal-internet-archive/>IPFS enabled personal internet archive</a>&nbsp;</table></table></div><div class=sidebar><div class=readme><div class=wikitext><p><a href=/>Full index of entries</a><p>Subjects:
<a href=/tags/bitcoin>bitcoin</a>&nbsp;
<a href=/tags/books>books</a>&nbsp;
<a href=/tags/brain>brain</a>&nbsp;
<a href=/tags/coding>coding</a>&nbsp;
<a href=/tags/food>food</a>&nbsp;
<a href=/tags/golang>golang</a>&nbsp;
<a href=/tags/ipfs>ipfs</a>&nbsp;
<a href=/tags/painting>painting</a>&nbsp;
<a href=/tags/protein-folding>protein-folding</a>&nbsp;
<a href=/tags/running>running</a>&nbsp;
<a href=/tags/science>science</a>&nbsp;
<a href=/tags/thoughts>thoughts</a>&nbsp;
<a href=/tags/tools>tools</a>&nbsp;<p>Github:
<a href=https://github.com/schollz>@schollz</a><p>Twitter:
<a href=https://twitter.com/yakczar>@yakczar</a><p align=center>* * *<p id=quoteP><div class=sidesearch style=font-size:small><form onsubmit="location.href='/search/?s='+document.getElementById('myInput').value;return false;">Search:
<input id=myInput size=15></form></div><p><a href=/about>About</a>&nbsp;&middot;&nbsp;<a href=/index.xml>RSS feed</a></div></div></div></div></div>